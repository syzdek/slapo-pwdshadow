.lf 1 stdin
.\" Copyright (c) 2023 David M. Syzdek <david@syzdek.net>
.\" All rights reserved.
.\"
.\" Dominus vobiscum. Et cum spiritu tuo.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted only as authorized by the OpenLDAP
.\" Public License.
.\"
.\" A copy of this license is available in the file LICENSE in the
.\" top-level directory of the distribution or, alternatively, at
.\" <http://www.OpenLDAP.org/license.html>.
.\"
.TH SLAPO_PWDSHADOW 5 "RELEASEDATE" "slapo-pwdshadow LDVERSION"
.SH NAME
slapo\-pwdshadow \- Password Policy conversion to RFC2256 Shadow attribtues overlay
.SH SYNOPSIS
ETCDIR/slapd.conf
.SH DESCRIPTION
.LP
The
.BR pwdshadow
overlay translates the attributes used by the
.BR ppolicy
overlay into attributes compatible with the attributes in the
.BR shadowAccount
object class defined by
.IR RFC2307 .
The attribtues generated by
.BR pwdshadow
can be used instead of the manually maintained attributes of
.BR shadowAccount.

.SH CONFIGURATION
These
.BR slapd.conf (5)
configuration options apply to the
.BR pwdshadow
overlay. They shoud appear after
the
.BR overlay
directive.

.TP 4
.BI pwdshadow_default " <policyDN> "
Specify the DN of the
.B pwdPolicy
and
.B pwdShadowPolicy
objects to use when no specific policy is set on a given user's entry. If there
is no specific policy for an entry and no default is given, then the attributes
.BR pwdShadowInactive ,
.BR pwdShadowMax ,
.BR pwdShadowMin ,
and
.B pwdShadowWarning
will not be generated. The default policy may be specified in the config backend
by setting
.BR olcPwdShadowDefault .

.TP 4
.BI pwdshadow_use_policies " on " | " off "
Specifies that the
.B pwdPolicy
and
.B pwdShadowPolicy
attributes should be retrieved from the DN specified by either the
.B pwdPolicySubentry
attribute (if present in the directory user's entry) or the
.B pwdshadow_default
configuration option. If this option is disabled, then only the
.B pwdShadowLastChanged
and
.B pwdShadowExpire
attributes will be generatd by the overlay. This option may be specified in the
config backend by setting
.BR olcPwdShadowUsePolicies .
The default is
.IR on .

.TP 4
.BI pwdshadow_overrides " on " | " off "
The generated values for
.B pwdShadow
attributes can be manually overridden by setting the equivalent
.B shadowAccount
attributes on the directory user's entry. This option may be specified in the
config backend by setting
.BR olcPwdShadowOverrides .
The default is
.IR on .

.SH OPERATIONAL ATTRIBUTES
The operational attributes used by the
.B pwdshadow
overlay are stored in the user's entry. Most of these attributes are not
intended to be changed directly by users; they are used to present the policy
attributes from the
.B ppolicy
module in a format compatible with most LDAP auth implementations used by
Linux distributions. However, if
.B pwdshadow_overrides
is enabled, the values of the operational attributes generated by the overlay
may be overridden by setting the equivelent
.B shadowAccount
attributes on the directory user's entry. The operational attributes have been
detailed here so that systems administrators can configure their systems to
use the generated LDAP attributes.

.TP 4
.B userPassword
The
.B userPassword
attribute is not part of the
.B pwdshadow
overlay, however it is tracked by the overlay. Please refer to the standard
OpenLDAP schema for its definition.

.TP 4
.B pwdEndTime
The
.B pwdEndTime
attribute is not part of the
.B pwdshadow
overlay, however it is used to determine the value of
.B pwdShadowExpire
if the attribute
.B shadowExpire
is not present on the directory user's entry. Please refer to the man page for
.BR slapo-ppolicy (5)
overlay for its definition.

.TP 4
.B pwdPolicySubentry
The
.B pwdPolicySubentry
attribute is not part of the
.B pwdshadow
overlay, however it is used to determine the
.B pwdPolicy
and
.B pwdShadowPolicy
subentry that is to be used for this particular directory user. Please refer
to the man page for
.BR slapo-ppolicy (5)
module for its definition.

.TP 4
.B pwdShadowGenerate
The
.BR pwdShadowGenerate
attribute controls if the module generates attributes for this particular
directory user. If the attribute is not present or is not set (its value is
"FALSE"), then the module will not generate attributes for this particilar
directory user. If this attribute is removed from the directory user or is unset
(its value changes from "TRUE" to "FALSE"), then this module's attributes will
be removed from the directory user. If attribute is set (added with or changed
to a value of "TRUE"), then the pwdShadow attributes will be generated and
added to the directory user's entry.
.HP 4
.EX
(  1.3.6.1.4.1.27893.4.2.2.1
   NAME 'pwdShadowGenerate'
   DESC 'generate shadowAccount equivalent attributes'
   EQUALITY booleanMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
   SINGLE-VALUE
   USAGE directoryOperation )
.EE

.TP 4
.B pwdShadowExpire
This attribute contains the date of the expiration of the account, expressed
as the number of days since January 1, 1970. If
.B pwdEndTime
is present on the user's entry, then
.B pwdShadowExpire
is derived from the value of
.BR pwdEndTime .
If
.B pwdEndTime
is not present on the user's entry and
.B pwdShadowAutoExpire
is set on the
.B pwdShadowPolicy
object's entry, then
.B pwdShadowExpire
is derived by adding the values of
.BR pwdShadowLastChange ,
.BR pwdShadowMax ,
and
.BR pwdShadowInactive .
Both
.BR pwdShadowLastChange
and
.B pwdShadowMax
must be present on the user's entry to generate the value using autoexpire.
This attribute can be overriden by setting
.BR shadowExpire .
.HP 4
.EX
(  1.3.6.1.4.1.27893.4.2.1.10
   NAME 'pwdShadowExpire'
   DESC 'shadowExpire equivalent derived from pwdEndTime'
   EQUALITY integerMatch
   ORDERING integerOrderingMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE
   NO-USER-MODIFICATION
   USAGE directoryOperation )
.EE

.TP 4
.B pwdShadowFlag
The overlay does not generate a value for this attribute.  It is included
by the overlay for completeness. This attribute can be overriden by setting
.BR shadowFlag .
.HP 4
.EX
(  1.3.6.1.4.1.27893.4.2.1.11
   NAME 'pwdShadowFlag'
   DESC 'duplicates shadowFlag'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE
   NO-USER-MODIFICATION
   USAGE directoryOperation )
.EE

.TP 4
.B pwdShadowInactive
The number of days after a password has expired during which the password
should still be accepted. If
.B pwdGraceExpiry
is present on the
.B pwdPolicy
object's entry, then
.B pwdShadowInactive
is derived from the value of
.BR pwdGraceExpiry .
This attribute can  be  overriden  by setting
.BR shadowInactive .
.HP 4
.EX
(  1.3.6.1.4.1.27893.4.2.1.9
   NAME 'pwdShadowInactive'
   DESC 'shadowInactive equivalent derived from pwdGraceExpiry'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE
   NO-USER-MODIFICATION
   USAGE directoryOperation )
.EE

.TP 4
.B pwdShadowLastChange
.LP
.RS 4
(  1.3.6.1.4.1.27893.4.2.1.5
   NAME 'pwdShadowLastChange'
   DESC 'The auto-generated value for shadowLastChange'
   EQUALITY integerMatch
   ORDERING integerOrderingMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE
   NO-USER-MODIFICATION
   USAGE directoryOperation )
.RE

.TP 4
.B pwdShadowMax
.LP
.RS 4
(  1.3.6.1.4.1.27893.4.2.1.7
   NAME 'pwdShadowMax'
   DESC 'The value of pwdMaxAge converted for shadowMax'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE
   NO-USER-MODIFICATION
   USAGE directoryOperation )
.RE

.TP 4
.B pwdShadowMin
.LP
.RS 4
(  1.3.6.1.4.1.27893.4.2.1.6
   NAME 'pwdShadowMin'
   DESC 'The value of pwdMinAge converted for shadowMin'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE
   NO-USER-MODIFICATION
   USAGE directoryOperation )
.RE

.TP 4
.B pwdShadowWarning
.LP
.RS 4
(  1.3.6.1.4.1.27893.4.2.1.8
   NAME 'pwdShadowWarning'
   DESC 'The value of pwdExpireWarning converted for shadowWarning'
   EQUALITY integerMatch
   SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
   SINGLE-VALUE
   NO-USER-MODIFICATION
   USAGE directoryOperation )
.RE

.SH EXAMPLES
.LP
.RS 4
.nf
database mdb
suffix dc=example,dc=com
\|...
overlay pwdshadow
pwdshadow_default "cn=Standard,ou=Policies,dc=example,dc=com"
pwdshadow_override on
.fi
.RE

.SH SEE ALSO
.BR ldap (3),
.BR slapd.conf (5),
.BR slapd\-config (5),
.BR slapo\-ppolicy (5),
.BR shadow (5).
.LP
"OpenLDAP Administrator's Guide" (http://www.OpenLDAP.org/doc/admin/)
.LP
IETF LDAP password policy proposal by P. Behera, L. Poitou and J.
Sermersheim:  documented in IETF document
"draft-behera-ldap-password-policy-10.txt".
.LP
"An Approach for Using LDAP as a Network Information Service" by L. Howard:
documented in RFC2022.

.SH BUGS
The LDAP Password Policy specification is not yet an approved standard, and it
is still evolving. This code will continue to be in flux until the
specification is finalized.

.SH ACKNOWLEDGEMENTS
This module was written in 2004 by David M. Syzdek of Alaska Communicatins and
is modeled after slapo-ppolicy, slapo-refint, and slapo-memberof.

.\" end of man page
