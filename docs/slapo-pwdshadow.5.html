

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p     { margin-top: 0; margin-bottom: 0; }
       pre   { margin-top: 0; margin-bottom: 0; }
       table { margin-top: 0; margin-bottom: 0; }
</style>
<title>SLAPO_PWDSHADOW</title>

</head>
<body>

<h1 align=center>SLAPO_PWDSHADOW</h1>













<hr>


<a name="NAME"></a>
<h2>NAME</h2>



<p style="margin-left:11%; margin-top: 1em">slapo&minus;pwdshadow
&minus; Password Policy conversion to RFC2256 Shadow
attributes overlay</p>

<a name="SYNOPSIS"></a>
<h2>SYNOPSIS</h2>



<p style="margin-left:11%; margin-top: 1em">/usr/local/etc/openldap/slapd.conf</p>

<a name="DESCRIPTION"></a>
<h2>DESCRIPTION</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b>pwdshadow</b> overlay translates the attributes used by
the <b>ppolicy</b> overlay into attributes compatible with
the attributes in the <b>shadowAccount</b> object class
defined by <i>RFC2307</i>. The attribtues generated by
<b>pwdshadow</b> can be used instead of the manually
maintained attributes of <b>shadowAccount.</b></p>

<a name="CONFIGURATION"></a>
<h2>CONFIGURATION</h2>


<p style="margin-left:11%; margin-top: 1em">These
<b>slapd.conf</b>(5) configuration options apply to the
<b>pwdshadow</b> overlay. They shoud appear after the
<b>overlay</b> directive.</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdshadow_default</b>
<i>&lt;policyDN&gt;</i> <br>
Specify the DN of the <b>pwdPolicy</b> and
<b>pwdShadowPolicy</b> objects to use when no specific
policy is set on a given user&rsquo;s entry. If there is no
specific policy for an entry and no default is given, then
the attributes <b>pwdShadowInactive</b>,
<b>pwdShadowMax</b>, <b>pwdShadowMin</b>, and
<b>pwdShadowWarning</b> will not be generated. The default
policy may be specified in the config backend by setting
<b>olcPwdShadowDefault</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdshadow_use_policies</b>
<i>on</i> <b>|</b> <i>off</i> <br>
Specifies that the <b>pwdPolicy</b> and
<b>pwdShadowPolicy</b> attributes should be retrieved from
the DN specified by either the <b>pwdPolicySubentry</b>
attribute (if present in the directory user&rsquo;s entry)
or the <b>pwdshadow_default</b> configuration option. If
this option is disabled, then only the
<b>pwdShadowLastChanged</b> and <b>pwdShadowExpire</b>
attributes will be generatd by the overlay. This option may
be specified in the config backend by setting
<b>olcPwdShadowUsePolicies</b>. The default is
<i>on</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdshadow_overrides</b>
<i>on</i> <b>|</b> <i>off</i> <br>
The generated values for <b>pwdShadow</b> attributes can be
manually overridden by setting the equivalent
<b>shadowAccount</b> attributes on the directory
user&rsquo;s entry. This option may be specified in the
config backend by setting <b>olcPwdShadowOverrides</b>. The
default is <i>on</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdshadow_policy_ad</b>
<i>&lt;pwdShadowPolicySubentry-ad&gt;</i> <br>
The value of <i>&lt;pwdShadowPolicySubentry-ad&gt;</i> is
the name of the attribute which contains the reference to
the subentry containing the <b>pwdPolicy</b> and
<b>pwdShadowPolicy</b> objects used to generate
<b>pwdshadow</b> attributes for a particular directory user.
This option is useful for using the same subentry containing
policy objects used by other overlays such as
<b>pwdPolicy</b> and <b>slapo-ppolicy</b>(5). The attribute
must be DN-valued. This option may be specified in the
config backend by setting <b>olcPwdShadowPolicyAD</b>. The
default value is <i>pwdShadowPolicySubentry.</i></p>

<a name="OBJECT CLASS"></a>
<h2>OBJECT CLASS</h2>



<p style="margin-left:11%; margin-top: 1em"><b>pwdshadow</b>
overlay depends on the <b>pwdPolicy</b> and
<b>pwdShadowPolicy</b> object classes. The definition of
<b>pwdPolicy</b> is documented by <b>slapo-ppolicy</b>(5).
The definition of <b>pwdShadowPolicy</b> is as follows:</p>

<p style="margin-left:17%; margin-top: 1em">(
1.3.6.1.4.1.27893.4.2.3.1 <br>
NAME &rsquo;pwdShadowPolicy&rsquo; <br>
DESC &rsquo;Attributes for controlling pwdShadow
overlay&rsquo; <br>
SUP top <br>
AUXILIARY <br>
MAY ( pwdShadowAutoExpire ) )</p>

<p style="margin-left:11%; margin-top: 1em">Every account
that should have generated <b>pwdShadow</b> attributes
should have a <b>pwdPolicySubentry</b> attribute containing
the DN of a valid <b>pwdPolicy</b> and
<b>pwdShadowPolicy</b> entry and should have set the
<b>pwdShadowGenerate</b> attribute (its value is
<i>TRUE</i>) on the account&rsquo;s entry.</p>

<a name="OBJECT CLASS ATTRIBUTES"></a>
<h2>OBJECT CLASS ATTRIBUTES</h2>


<p style="margin-left:11%; margin-top: 1em">The following
details the meaning and use of attributes of the
<b>pwdShadowPolicy</b> object class.</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdShadowAutoExpire</b>
<br>
If this attribute is set (its value is <i>TRUE</i>) in the
<b>pwdShadowPolicy</b> object and <b>pwdEndTime</b> is not
set on the user&rsquo;s entry, then the value of
<b>pwdShadowExpire</b> will be calculated by adding the
values of <b>pwdShadowLastChange</b>, <b>pwdShadowMax</b>,
and <b>pwdShadowInactive</b>. If either
<b>pwdShadowLastChange</b> or <b>pwdShadowMax</b> are not
set on the user&rsquo;s entry, then no value will be set for
<b>pwdShadowExpire.</b> If <b>pwdShadowInactive</b> is not
set on the user&rsquo;s entry, then a default value of zero
is used for <b>pwdShadowInactive.</b></p>

<p style="margin-left:17%; margin-top: 1em">(
1.3.6.1.4.1.27893.4.2.2.2 <br>
NAME &rsquo;pwdShadowAutoExpire&rsquo; <br>
DESC &rsquo;generate pwdShadowExpire from pwdShadow
attributes&rsquo; <br>
EQUALITY booleanMatch <br>
SYNTAX 1.3.6.1.4.1.1466.115.121.1.7 <br>
SINGLE-VALUE )</p>

<a name="OPERATIONAL ATTRIBUTES"></a>
<h2>OPERATIONAL ATTRIBUTES</h2>


<p style="margin-left:11%; margin-top: 1em">The operational
attributes used by the <b>pwdshadow</b> overlay are stored
in the user&rsquo;s entry. Most of these attributes are not
intended to be changed directly by users; they are used to
present the policy attributes from the <b>ppolicy</b> module
in a format compatible with most LDAP auth implementations
used by Linux distributions. However, if
<b>pwdshadow_overrides</b> is enabled, the values of the
operational attributes generated by the overlay may be
overridden by setting the equivelent <b>shadowAccount</b>
attributes on the directory user&rsquo;s entry. The
operational attributes have been detailed here so that
systems administrators can configure their systems to use
the generated LDAP attributes.</p>


<p style="margin-left:11%; margin-top: 1em"><b>userPassword</b>
<br>
The <b>userPassword</b> attribute is not part of the
<b>pwdshadow</b> overlay, however it is tracked by the
overlay. Please refer to the standard OpenLDAP schema for
its definition.</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdEndTime</b>
<br>
The <b>pwdEndTime</b> attribute is not part of the
<b>pwdshadow</b> overlay, however it is used to determine
the value of <b>pwdShadowExpire</b> if the attribute
<b>shadowExpire</b> is not present on the directory
user&rsquo;s entry. Please refer to the man page for
<b>slapo-ppolicy</b>(5) overlay for its definition.</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdShadowPolicySubentry</b>
<br>
This attribute refers directly to the <b>pwdPolicy</b> and
<b>pwdShadowPolicy</b> subentry that is to be used to
generate <b>pwdshadow</b> attributes for this particular
directory user. If <b>pwdShadowPolicySubentry</b> exists, it
must contain the DN of valid <b>pwdPolicy</b> and
<b>pwdShadowPolicy</b> objects. If the subentry does not
exist, the <b>pwdshadow</b> module will use the default
policy subentry to generate <b>pwdshadow</b> attribtues. If
there is no default, or the referenced subentry does not
exist, then <b>pwdShadowMin</b>, <b>pwdShadowMax</b>,
<b>pwdShadowWarning</b>, and <b>pwdShadowInactive</b>
attributes will not be generated or will be removed if they
are already present on the user&rsquo;s entry. An alternate
attribute can be used to specify the <b>pwdPolicy</b> and
<b>pwdShadowPolicy</b> subentry using the
<b>pwdshadow_policy_attr</b> option in
<i>slapd.conf</i>.</p>

<p style="margin-left:17%; margin-top: 1em">(
1.3.6.1.4.1.27893.4.2.2.3 <br>
NAME &rsquo;pwdShadowPolicySubentry&rsquo; <br>
DESC &rsquo;The pwdShadowPolicy subentry in effect for this
object&rsquo; <br>
EQUALITY distinguishedNameMatch <br>
SYNTAX 1.3.6.1.4.1.1466.115.121.1.12 <br>
SINGLE-VALUE <br>
USAGE directoryOperation )</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdShadowGenerate</b>
<br>
The <b>pwdShadowGenerate</b> attribute controls if the
module generates attributes for this particular directory
user. If the attribute is not present or is not set (its
value is &quot;FALSE&quot;), then the module will not
generate attributes for this particilar directory user. If
this attribute is removed from the directory user or is
unset (its value changes from &quot;TRUE&quot; to
&quot;FALSE&quot;), then this module&rsquo;s attributes will
be removed from the directory user. If attribute is set
(added with or changed to a value of &quot;TRUE&quot;), then
the pwdShadow attributes will be generated and added to the
directory user&rsquo;s entry.</p>

<p style="margin-left:17%; margin-top: 1em">(
1.3.6.1.4.1.27893.4.2.2.1 <br>
NAME &rsquo;pwdShadowGenerate&rsquo; <br>
DESC &rsquo;generate shadowAccount equivalent
attributes&rsquo; <br>
EQUALITY booleanMatch <br>
SYNTAX 1.3.6.1.4.1.1466.115.121.1.7 <br>
SINGLE-VALUE <br>
USAGE directoryOperation )</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdShadowExpire</b>
<br>
This attribute contains the date of the expiration of the
account, expressed as the number of days since January 1,
1970. If <b>pwdEndTime</b> is present on the user&rsquo;s
entry, then <b>pwdShadowExpire</b> is derived from the value
of <b>pwdEndTime</b>. If <b>pwdEndTime</b> is not present on
the user&rsquo;s entry and <b>pwdShadowAutoExpire</b> is set
on the <b>pwdShadowPolicy</b> object&rsquo;s entry, then
<b>pwdShadowExpire</b> is derived by adding the values of
<b>pwdShadowLastChange</b>, <b>pwdShadowMax</b>, and
<b>pwdShadowInactive</b>. Both <b>pwdShadowLastChange</b>
and <b>pwdShadowMax</b> must be present on the user&rsquo;s
entry to generate the value using autoexpire. This attribute
can be overriden by setting <b>shadowExpire</b>.</p>

<p style="margin-left:17%; margin-top: 1em">(
1.3.6.1.4.1.27893.4.2.1.10 <br>
NAME &rsquo;pwdShadowExpire&rsquo; <br>
DESC &rsquo;shadowExpire equivalent derived from
pwdEndTime&rsquo; <br>
EQUALITY integerMatch <br>
ORDERING integerOrderingMatch <br>
SYNTAX 1.3.6.1.4.1.1466.115.121.1.27 <br>
SINGLE-VALUE <br>
NO-USER-MODIFICATION <br>
USAGE directoryOperation )</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdShadowFlag</b>
<br>
The overlay does not generate a value for this attribute. It
is included by the overlay for completeness. This attribute
can be overriden by setting <b>shadowFlag</b>.</p>

<p style="margin-left:17%; margin-top: 1em">(
1.3.6.1.4.1.27893.4.2.1.11 <br>
NAME &rsquo;pwdShadowFlag&rsquo; <br>
DESC &rsquo;duplicates shadowFlag&rsquo; <br>
EQUALITY integerMatch <br>
SYNTAX 1.3.6.1.4.1.1466.115.121.1.27 <br>
SINGLE-VALUE <br>
NO-USER-MODIFICATION <br>
USAGE directoryOperation )</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdShadowInactive</b>
<br>
The number of days after a password has expired during which
the password should still be accepted. If
<b>pwdGraceExpiry</b> is present on the <b>pwdPolicy</b>
object&rsquo;s entry, then <b>pwdShadowInactive</b> is
derived from the value of <b>pwdGraceExpiry</b>. This
attribute can be overriden by setting
<b>shadowInactive</b>.</p>

<p style="margin-left:17%; margin-top: 1em">(
1.3.6.1.4.1.27893.4.2.1.9 <br>
NAME &rsquo;pwdShadowInactive&rsquo; <br>
DESC &rsquo;shadowInactive equivalent derived from
pwdGraceExpiry&rsquo; <br>
EQUALITY integerMatch <br>
SYNTAX 1.3.6.1.4.1.1466.115.121.1.27 <br>
SINGLE-VALUE <br>
NO-USER-MODIFICATION <br>
USAGE directoryOperation )</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdShadowLastChange</b>
<br>
This attribute contains the date of the last password
change, expressed as the number of days since January 1,
1970. This attribute is set to the current date when the
<b>userPassword</b> attribute is updated. If
<b>pwdShadowGenerate</b> is set after the password was set
and <b>pwdChangedTime</b> is present on the user&rsquo;s
entry, then <b>pwdShadowLastChange</b> is derived from the
value of <b>pwdChangedTime</b>. This attribute can be
overriden by setting <b>shadowLastChange</b>.</p>

<p style="margin-left:17%; margin-top: 1em">(
1.3.6.1.4.1.27893.4.2.1.5 <br>
NAME &rsquo;pwdShadowLastChange&rsquo; <br>
DESC &rsquo;The generated value for shadowLastChange&rsquo;
<br>
EQUALITY integerMatch <br>
ORDERING integerOrderingMatch <br>
SYNTAX 1.3.6.1.4.1.1466.115.121.1.27 <br>
SINGLE-VALUE <br>
NO-USER-MODIFICATION <br>
USAGE directoryOperation )</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdShadowMax</b>
<br>
The number of days following the last password change on
which the password must again be changed. <b>pwdMaxAge</b>
is present on the <b>pwdPolicy</b> object&rsquo;s entry,
then <b>pwdShadowMax</b> is derived from the value of
<b>pwdMaxAge</b>. This attribute can be overriden by setting
<b>shadowMax</b>.</p>

<p style="margin-left:17%; margin-top: 1em">(
1.3.6.1.4.1.27893.4.2.1.7 <br>
NAME &rsquo;pwdShadowMax&rsquo; <br>
DESC &rsquo;shadowMax equivalent derived from
pwdMaxAge&rsquo; <br>
EQUALITY integerMatch <br>
SYNTAX 1.3.6.1.4.1.1466.115.121.1.27 <br>
SINGLE-VALUE <br>
NO-USER-MODIFICATION <br>
USAGE directoryOperation )</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdShadowMin</b>
<br>
The minimum number of days after the password was last
changed before the password may again be changed. If
<b>pwdMinAge</b> is present on the <b>pwdPolicy</b>
object&rsquo;s entry, then <b>pwdShadowMin</b> is derived
from the value of <b>pwdMinAge</b>. This attribute can be
overriden by setting <b>shadowMin</b>.</p>

<p style="margin-left:17%; margin-top: 1em">(
1.3.6.1.4.1.27893.4.2.1.6 <br>
NAME &rsquo;pwdShadowMin&rsquo; <br>
DESC &rsquo;shadowMin equivalent derived from
pwdMinAge&rsquo; <br>
EQUALITY integerMatch <br>
SYNTAX 1.3.6.1.4.1.1466.115.121.1.27 <br>
SINGLE-VALUE <br>
NO-USER-MODIFICATION <br>
USAGE directoryOperation )</p>


<p style="margin-left:11%; margin-top: 1em"><b>pwdShadowWarning</b>
<br>
The number of days before a password is going to expire. If
<b>pwdExpireWarning</b> is present on the <b>pwdPolicy</b>
object&rsquo;s entry, then <b>pwdShadowWarning</b> is
derived from the value of <b>pwdExpireWarning</b>. This
attribute can be overriden by setting
<b>shadowWarning</b>.</p>

<p style="margin-left:17%; margin-top: 1em">(
1.3.6.1.4.1.27893.4.2.1.8 <br>
NAME &rsquo;pwdShadowWarning&rsquo; <br>
DESC &rsquo;shadowWarning equivalent derived from
pwdExpireWarning&rsquo; <br>
EQUALITY integerMatch <br>
SYNTAX 1.3.6.1.4.1.1466.115.121.1.27 <br>
SINGLE-VALUE <br>
NO-USER-MODIFICATION <br>
USAGE directoryOperation )</p>

<a name="EXAMPLES"></a>
<h2>EXAMPLES</h2>


<p style="margin-left:17%; margin-top: 1em">database mdb
<br>
suffix dc=example,dc=com <br>
... <br>
overlay pwdshadow <br>
pwdshadow_default
&quot;cn=Standard,ou=Policies,dc=example,dc=com&quot; <br>
pwdshadow_override on</p>

<a name="SEE ALSO"></a>
<h2>SEE ALSO</h2>



<p style="margin-left:11%; margin-top: 1em"><b>ldap</b>(3),
<b>slapd.conf</b>(5), <b>slapd&minus;config</b>(5),
<b>slapo&minus;ppolicy</b>(5), <b>shadow</b>(5).</p>

<p style="margin-left:11%; margin-top: 1em">&quot;OpenLDAP
Administrator&rsquo;s Guide&quot;
(http://www.OpenLDAP.org/doc/admin/)</p>

<p style="margin-left:11%; margin-top: 1em">IETF LDAP
password policy proposal by P. Behera, L. Poitou and J.
Sermersheim: documented in IETF document
&quot;draft-behera-ldap-password-policy-10.txt&quot;.</p>

<p style="margin-left:11%; margin-top: 1em">&quot;An
Approach for Using LDAP as a Network Information
Service&quot; by L. Howard: documented in RFC2022.</p>

<a name="BUGS"></a>
<h2>BUGS</h2>


<p style="margin-left:11%; margin-top: 1em">The LDAP
Password Policy specification is not yet an approved
standard, and it is still evolving. This code will continue
to be in flux until the specification is finalized.</p>

<a name="ACKNOWLEDGEMENTS"></a>
<h2>ACKNOWLEDGEMENTS</h2>


<p style="margin-left:11%; margin-top: 1em">This module was
written in 2023 by David M. Syzdek of Alaska Communicatins
and is modeled after slapo-ppolicy, slapo-refint, and
slapo-memberof.</p>
<hr>
</body>
</html>
